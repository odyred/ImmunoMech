using System.IO;
using ISAAR.MSolve.LinearAlgebra.Tests.Utilities;

namespace ISAAR.MSolve.LinearAlgebra.Tests.TestData
{
    /// <summary>
    /// A square asymmetric 10-by-10 matrix that is invertible, but LU factorization needs pivoting.
    /// Authors: Serafeim Bakalakos
    /// </summary>
    internal static class SquareInvertible10by10
    {
        internal const int Order = 10;

        internal static double[,] Matrix => new double[,] {
            { 1.0000,    2.6667,    7.0000,    5.0000,    2.5000,    9.0000,    6.0000,    2.2500,    4.0000,    3.0000 },
            { 0.0000,    0.3333,    1.0000,   -2.5000,    5.5000,   -7.7500,    2.0000,    5.7500,    3.0000,    2.0000 },
            { 2.0000,    2.0000,    4.0000,    9.0000,    1.7500,    5.0000,    3.5000,    2.0000,    6.0000,    8.0000 },
            { 1.0000,    1.0000,    3.0000,    5.0000,    1.7500,    6.0000,    4.0000,    7.0000,    6.0000,    9.0000 },
            { 5.0000,    0.6667,    4.5000,    5.0000,    0.2500,    2.3333,    1.5000,    1.2500,    9.0000,    0.7500 },
            { 0.3333,    2.0000,    4.0000,    5.0000,    5.0000,    9.0000,    2.5000,    4.0000,    1.0000,    3.0000 },
            { 0.2500,    6.0000,    8.0000,    0.7500,    1.0000,    3.0000,    8.0000,    1.2500,    1.0000,    2.0000 },
            { 1.0000,    1.0000,    1.0000,    7.0000,    1.0000,    5.0000,    2.0000,    7.0000,    1.0000,    2.0000 },
            { 3.5000,    9.0000,    9.0000,    2.0000,    8.0000,    4.0000,    2.5000,    6.0000,    7.0000,    9.0000 },
            { 3.0000,    7.0000,    9.0000,    4.0000,    2.6667,    9.0000,    8.0000,    5.0000,    7.0000,    3.0000 }};

        internal static double[] Lhs => new double[] {
            3.4484, 1.9563, 2.7385, 4.2828, 5.3064, 4.3251, 0.1117, 4.0487, 2.6311, 2.6269
        };

        internal static double[] Rhs => MatrixOperations.MatrixTimesVector(Matrix, Lhs);

        internal static double[,] FactorL => new double[,] {
            { 1.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.700000000000000, 1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.200000000000000, 0.296878936778343,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.200000000000000, 0.101561996458584, -0.113249698822564,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.000000000000000, 0.039058700551134,  0.176818919005663, -0.484906542960240,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.050000000000000, 0.699220466618463,  0.844451573716728, -0.331295118269131, -0.863097189214223,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.600000000000000, 0.773437271117538,  0.406895919175001,  0.052792355932608, -0.684415331679188,  0.241574580261808,  1.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.400000000000000, 0.203123992917168,  0.231873657358311,  0.942630231346478, -0.024512562835827,  0.346259134817979, -0.586219649578724,  1.000000000000000,  0.000000000000000, 0.000000000000000},
            { 0.200000000000000, 0.101561996458584,  0.345123356180875,  0.393366691999442,  0.151258061047848, -0.165741667413086,  0.355479089484414, -0.373132913343019,  1.000000000000000, 0.000000000000000},
            { 0.066660000000000, 0.229167553739405,  0.540742649585241,  0.391641616972103,  0.581445473311093, -0.628021544221750,  0.073364914263990,  0.198333706840520, -0.659496414881728, 1.000000000000000}
        };

        internal static double[,] FactorU => new double[,] {
            { 5.000000000000000, 0.666700000000000, 4.500000000000000,  5.000000000000000, 0.250000000000000,  2.333300000000000, 1.500000000000000,  1.250000000000000,  9.000000000000000,  0.750000000000000 },
            { 0.000000000000000, 8.533310000000000, 5.850000000000000, -1.500000000000000, 7.825000000000000,  2.366690000000000, 1.450000000000000,  5.125000000000000,  0.699999999999999,  8.475000000000000 },
            { 0.000000000000000, 0.000000000000000, 4.363258219846695,  4.445318405167514, 0.126922319709468,  7.830719589116065, 5.269525541671404,  0.478495449010993,  1.992184744255161,  0.333951010803546 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  6.655773965243499, 0.169651292192538,  5.179800873632784, 2.149507285667150,  6.283684233638220, -0.645479075235204,  1.027081931408493 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 5.254188422424477, -6.715339873935628, 2.053923221210496,  8.512216710419459,  2.307405929749960,  2.107967404794224 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000, -9.464114793276034, 4.946127816512377,  6.628553101741168,  0.155913636719474, -2.085750939237665 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 3.931767755773501,  3.984307335236524,  1.823617652005219, -2.248396632918166 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000, -5.326013241595878,  3.475940545000401,  4.388758952026945 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000,  4.020824604788080,  9.242293465315168 },
            { 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  3.279189768619025 }
        };

        internal const double Determinant = 17011962.9297146;

        internal static double[,] Inverse => new double[,] {
            { -2.27411235611569928, -0.15826165906834855, -0.03971366478919014,  0.54754530193387962,  0.84564546633614235,  1.76721370456951843,  1.07391361538651520, -0.62155870054409057, -0.48250146850855319,  0.01019672027462176 },
            {  0.22484785089916492,  0.00497907689343147,  0.13355139007048836, -0.21626167761339685, -0.27191124159200897, -0.36042272648326040, -0.27315652370363785,  0.13047889239071397,  0.11312595580665039,  0.24862184749402985 },
            {  0.85524708549332884, -0.02663142509079858, -0.21829010594211209, -0.07597446983339490, -0.01766347951461328, -0.53299319519938937, -0.06431049500906261,  0.27920956699260274,  0.26180037063438799, -0.41872053823446070 },
            {  0.34237656340852235,  0.03459601132902049,  0.11949903520731535, -0.19007445235964410, -0.11792258334227484, -0.27461758503063410, -0.15251968219587270,  0.18773290343148835,  0.06545173333927046, -0.02961375774379703 },
            { -0.39068346608479154,  0.07845459651457942,  0.09774788148584986, -0.01521396023045585,  0.06844010119667270,  0.43057281385323593,  0.07445500310690192, -0.19743881021017737, -0.11463880104990820,  0.10158403387034382 },
            { -0.11960415368814295, -0.05119078661773287, -0.03566587991127522,  0.06853351500300096,  0.01436951605887161,  0.14708417097528839, -0.00814944922996601, -0.08252364659457270, -0.04128303503403435,  0.07686109851615172 },
            { -0.92793063264049869,  0.03570990897064419,  0.11967641827069420,  0.18738507248004255,  0.20472013048747825,  0.70845142046674026,  0.38479902039033159, -0.33005309126766913, -0.32640176089583317,  0.20590823734853814 },
            {  0.23449114961146644,  0.01001523641491844, -0.13703778143468803,  0.02633392674276008, -0.03144987262923478, -0.20618716346918950, -0.05966091488615446,  0.18859627051238026,  0.08264185150921957, -0.07456849694250196 },
            {  0.82730381666590347,  0.09025541547457155,  0.05933160954592846, -0.21358055509691320, -0.30999188330290900, -0.70096781085450788, -0.53533297754915421,  0.16046882480870420,  0.15376464768899153,  0.16213121995953983 },
            { -0.41339744413805679, -0.05827031189181564,  0.01456033811781599,  0.20111566009168913,  0.12490019370398427,  0.30495337890162211,  0.24042238135589683, -0.15636978776831514, -0.05449355077458019, -0.08532973391890820 }
        };

        internal static string FilePath => Directory.GetParent(Directory.GetCurrentDirectory()).Parent.Parent.FullName
            + @"\Resources\SquareInvertible10by10.txt";
    }
}
